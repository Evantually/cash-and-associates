{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block app_content %}
    <h1>{{ _('Hi, %(username)s!', username=current_user.username) }}</h1>
    <h2>{{ title }} | {{ race.highest_class }} Class Vehicles | {% if race.laps == 0 %}Sprint {% else %}{{ race.laps }} Laps {% endif %}</h2>
    <h3>Race Results</h3>
    {% if racers | length > 0 %}
    <div class="row">
        <div class="col-md-3">
            <img width="100%" src="{{ url_for('static', filename='imgs/gold-trophy.png') }}">
        </div>
        <div class="col-md-6">
            {% if racers[0].car_info.image %}
            <img width="100%" src="{{ racers[0].car_info.image }}">
            {% else %}
            <img width=100% src="{{ racers[0].car_stock.image }}">
            {% endif %}
        </div>
        <div class="col-md-3">
            <h2>1st Place | {{ "${:,.0f}".format(racers[0].payout) }}</h2>
            <h3>{{ racers[0].user_info.username }}</h3>
            <div class="row">                
                <div class="col-md-12">
                    {% for lap in racers[0].laps %}
                    <div class="row">
                        <div class="col-md-12">
                            Lap {{loop.index}}: {{ lap }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    <br>
    {% endif %}
    {% if racers | length > 3 %}
    <div class="row">
        {% if racers[1] %}
        <div class="col-md-6">
            <div class="col-md-3">
                <img width="100%" src="{{ url_for('static', filename='imgs/silver-trophy.png') }}">
            </div>
            <div class="col-md-6">
                {% if racers[1].car_info.image %}
                <img width="100%" src="{{ racers[1].car_info.image }}">
                {% else %}
                <img width=100% src="{{ racers[1].car_stock.image }}">
                {% endif %}
            </div>
            <div class="col-md-3">
                <h2>2nd Place | {{ "${:,.0f}".format(racers[1].payout) }}</h2>
                <h3>{{ racers[1].user_info.username }}</h3>
                <div class="row">
                    <div class="col-md-12">
                        {% for lap in racers[1].laps %}
                        <div class="row">
                            <div class="col-md-12">
                                Lap {{loop.index}}: {{ lap }}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        {% if racers[2] %}
        <div class="col-md-6" style="margin-left:30px;">
            <div class="col-md-2">
                <img width="100%" src="{{ url_for('static', filename='imgs/bronze-trophy.png') }}">
            </div>
            <div class="col-md-4">
                {% if racers[2].car_info.image %}
                <img width="100%" src="{{ racers[2].car_info.image }}">
                {% else %}
                <img width=100% src="{{ racers[2].car_stock.image }}">
                {% endif %}
            </div>
            <div class="col-md-3">
                <h2>3rd Place | {{ "${:,.0f}".format(racers[2].payout) }}</h2>
                <h3>{{ racers[2].user_info.username }}</h3>
                <div class="row">
                    <div class="col-md-12">
                        {% for lap in racers[2].laps %}
                        <div class="row">
                            <div class="col-md-12">
                                Lap {{loop.index}}: {{ lap }}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
    {% endif %}
    <table class="table table-hover">
        <tr>
            <th>Position</th>
            <th></th>
            {% if racers | length > 3 %}
            {% else %}
            <th>Payout</th>
            {% endif %}
            <th>Car Class</th>
            <th>Car Model</th>
            <th>Racer</th>
            <th>Car Name</th>
            <th>Lap Times</th>
        </tr>
        {% if racers | length > 3 %}
            {% for racer in racers[3:] %}
            <tr>
                <td>{{ racer.end_position }}</td>
                <td>
                    {% if racer.car_info.image %}
                    <img height="128px" src="{{ racer.car_info.image }}">
                    {% else %}
                    <img height="128px" src="{{ racer.car_stock.image }}">
                    {% endif %}
                </td>
                <td>{{ racer.car_stock.car_class }}</td>
                <td>{{ racer.car_stock.name }}</td>
                <td>{{ racer.user_info.username }}</td>
                <td>{{ racer.car_info.name }}</td>
                <td>
                    {% for lap in racer.laps %}
                    Lap {{loop.index}}: {{ lap }}<br>
                    {% endfor %}
                </td>
            </tr>
            {% endfor %}
        {% else %}
            {% for racer in racers[1:] %}
            <tr>
                <td>{{ racer.end_position }}</td>
                <td>
                    {% if racer.car_info.image %}
                    <img height="128px" src="{{ racer.car_info.image }}">
                    {% else %}
                    <img height="128px" src="{{ racer.car_stock.image }}">
                    {% endif %}
                </td>
                <td>{{ "${:,.0f}".format(racer.payout) }}</td>
                <td>{{ racer.car_stock.car_class }}</td>
                <td>{{ racer.car_stock.name }}</td>
                <td>{{ racer.user_info.username }}</td>
                <td>{{ racer.car_info.name }}</td>
                <td>
                    {% for lap in racer.laps %}
                    Lap {{loop.index}}: {{ lap }}<br>
                    {% endfor %}
                </td>
            </tr>
            {% endfor %}
        {% endif %}
    </table>
    {% if dnfs | length > 0 %}
    <h3>DNFs</h3>
    <table class="table table-hover">
        <tr>
            <th></th>
            <th>Car Class</th>
            <th>Car Model</th>
            <th>Racer</th>
            <th>Car Name</th>
        </tr>
        {% for racer in dnfs %}
        <tr>
            <td>
                {% if racer.car_info.image %}
                <img height="128px" src="{{ racer.car_info.image }}">
                {% else %}
                <img height="128px" src="{{ racer.car_stock.image }}">
                {% endif %}
            </td>
            <td>{{ racer.car_stock.car_class }}</td>
            <td>{{ racer.car_stock.name }}</td>
            <td>{{ racer.user_info.username }}</td>
            <td>{{ racer.car_info.name }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
{% endblock %}

{% block scripts %}
{{ super() }}


{% endblock %}